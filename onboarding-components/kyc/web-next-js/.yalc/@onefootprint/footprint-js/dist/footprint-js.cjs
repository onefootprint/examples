'use strict';

Object.defineProperty(exports, '__esModule', { value: true });

var Ft = require('@onefootprint/postmate');

function _interopDefault (e) { return e && e.__esModule ? e : { default: e }; }

var Ft__default = /*#__PURE__*/_interopDefault(Ft);

var et=Object.defineProperty,tt=Object.defineProperties;var ot=Object.getOwnPropertyDescriptors;var T=Object.getOwnPropertySymbols;var ge=Object.prototype.hasOwnProperty,he=Object.prototype.propertyIsEnumerable;var ye=(e,t,o)=>t in e?et(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,g=(e,t)=>{for(var o in t||(t={}))ge.call(t,o)&&ye(e,o,t[o]);if(T)for(var o of T(t))he.call(t,o)&&ye(e,o,t[o]);return e},k=(e,t)=>tt(e,ot(t));var ke=(e,t)=>{var o={};for(var n in e)ge.call(e,n)&&t.indexOf(n)<0&&(o[n]=e[n]);if(e!=null&&T)for(var n of T(e))t.indexOf(n)<0&&he.call(e,n)&&(o[n]=e[n]);return o};var f=(e,t,o)=>new Promise((n,r)=>{var a=p=>{try{s(o.next(p));}catch(i){r(i);}},d=p=>{try{s(o.throw(p));}catch(i){r(i);}},s=p=>p.done?n(p.value):Promise.resolve(p.value).then(a,d);s((o=o.apply(e,t)).next());});var Ce="fp-session-id",Pe=typeof window!="undefined",Y="xfpsessionid",rt=()=>"10000000-1000-4000-8000-100000000000".replace(/[018]/g,e=>(+e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>+e/4).toString(16)),be=(e,t)=>new URL(t).searchParams.get(e),at=e=>{var t,o;try{let n=(o=(t=window==null?void 0:window.top)==null?void 0:t.location)==null?void 0:o.href;return n?be(e,n):null}catch(n){return null}},D=()=>Pe?be(Y,window.location.href)||at(Y):null,we=()=>{if((!Pe||!window.sessionStorage))return !1;try{let e="test";return sessionStorage.setItem(e,e),sessionStorage.removeItem(e),!0}catch(e){return !1}},st=()=>{let e=D()||rt();if(we())try{sessionStorage.setItem(Ce,e);}catch(t){console.error("Failed to create session id",t);}return e},it=()=>{let e=D();return e||(we()?sessionStorage.getItem(Ce):null)},ve=()=>it()||st(),L=(e,t=ve())=>{let o=new URL(e);return o.searchParams.set(Y,t),o.toString()};var B=ve;var E="3.15.1";var _=(s=>(s.Auth="auth",s.Components="components",s.Form="form",s.Render="render",s.UpdateLoginMethods="update_login_methods",s.Verify="verify",s.VerifyButton="verify-button",s))(_||{});var R=(d=>(d.auth="auth",d.canceled="canceled",d.clicked="clicked",d.closed="closed",d.completed="completed",d.relayToComponents="relayToComponents",d))(R||{}),U=(d=>(d.formSaveComplete="formSaveComplete",d.formSaveFailed="formSaveFailed",d.formSaved="formSaved",d.propsReceived="propsReceived",d.started="started",d.relayFromComponents="relayFromComponents",d))(U||{});var Se="footprint-inline-container",Ve="footprint-body-locked",Ie="footprint-overlay",lt="footprint-overlay-container",Ae=Se,xe=Ie,Oe="footprint-loading-indicator",M=e=>`${lt}-${e}`,V=(e,t)=>`${e}-${t}`,Fe=e=>f(void 0,null,function*(){Z(e),mt(e),yield ct(e);}),Le=e=>{let t=M(e),o=document.getElementById(t);if(o)return o;let n=document.createElement("div");return n.setAttribute("id",t),document.body.appendChild(n),n},ct=e=>f(void 0,null,function*(){let t=M(e),o=document.getElementById(t);if(!o)return;let n=o.querySelector("iframe.footprint-drawer");n&&(n==null||n.classList.add("footprint-drawer-closing"),yield new Promise(s=>{setTimeout(s,300);}));let r=o.querySelector("iframe.footprint-modal");r&&(r==null||r.classList.add("footprint-modal-closing"),yield new Promise(s=>{setTimeout(s,100);}));let a=V(xe,e),d=document.getElementById(a);d&&(d.classList.add("footprint-overlay-fading"),yield new Promise(s=>{setTimeout(s,200);}),o.remove(),d.remove(),document.body.classList.remove(Ve));}),Ee=(e,t)=>{let o=V(Ae,e),n=document.createElement("div");return n.classList.add(Se),n.setAttribute("id",o),t.appendChild(n),n},mt=e=>{let t=V(Ae,e),o=document.getElementById(t);o&&o.remove();},Z=e=>{let t=V(Oe,e),o=document.getElementById(t);o&&o.remove();},G=(e,t)=>{let o=V(Oe,t),n=ut(o);e.appendChild(n);},Re=(e,t)=>{document.body.classList.add(Ve);let o=document.createElement("div"),n=V(xe,t);return o.setAttribute("id",n),o.classList.add(Ie),e.appendChild(o),o},ut=e=>{let t=document.createElement("div");t.setAttribute("id",e),t.classList.add("footprint-loading-indicator");let o=document.createElement("div");o.classList.add("footprint-loading-spin");let n=document.createElementNS("http://www.w3.org/2000/svg","svg");n.setAttribute("width","24px"),n.setAttribute("height","24px"),n.setAttribute("fill","none"),n.setAttribute("aria-hidden","true");let r=document.createElementNS("http://www.w3.org/2000/svg","path");return r.setAttribute("d","M12 2a10 10 0 0 1 10 10h-2a7.999 7.999 0 0 0-8-8V2Z"),n.appendChild(r),o.appendChild(n),t.appendChild(o),t},Ke=e=>{let t=document.getElementById(M(e));t&&(t.style.opacity="1",t.style.display="block");},Te=e=>{let t=document.getElementById(M(e));t&&(t.style.opacity="0",t.style.display="none");},ee=(e,t="It looks like there was an issue loading the page. Try reloading and we'll get things back on track.")=>{let o=document.createElement("div");o.classList.add("modal-error-container"),o.setAttribute("role","dialog"),o.setAttribute("aria-modal","true"),o.setAttribute("aria-label","Oops! Something's not quite right.");let n=document.createElement("div");n.classList.add("modal-error");let r=document.createElement("button");r.setAttribute("aria-label","Close"),r.classList.add("modal-error-close-button"),r.addEventListener("click",()=>{e.remove();});let a=document.createElementNS("http://www.w3.org/2000/svg","svg");a.setAttribute("xmlns","http://www.w3.org/2000/svg"),a.setAttribute("width","20"),a.setAttribute("height","20"),a.setAttribute("viewBox","0 0 20 20"),a.setAttribute("fill","none");let d=document.createElementNS("http://www.w3.org/2000/svg","path");d.setAttribute("d","M5 5L15 15M15 5L5 15"),d.setAttribute("stroke","black"),d.setAttribute("stroke-width","1.5"),d.setAttribute("stroke-linecap","round"),a.appendChild(d),r.appendChild(a);let s=document.createElementNS("http://www.w3.org/2000/svg","svg");s.setAttribute("xmlns","http://www.w3.org/2000/svg"),s.setAttribute("width","40"),s.setAttribute("height","40"),s.setAttribute("viewBox","0 0 40 40"),s.setAttribute("fill","none"),s.setAttribute("class","error-icon");let p=document.createElementNS("http://www.w3.org/2000/svg","path");p.setAttribute("d","M25 15L15 25M25 25L15 15M35 20C35 28.2843 28.2843 35 20 35C11.7157 35 5 28.2843 5 20C5 11.7157 11.7157 5 20 5C28.2843 5 35 11.7157 35 20Z"),p.setAttribute("stroke","black"),p.setAttribute("stroke-width","3.33333"),p.setAttribute("stroke-linecap","round"),p.setAttribute("stroke-linejoin","round"),s.appendChild(p);let i=document.createElement("h2");i.textContent="Oops! Something's not quite right.";let c=document.createElement("p");c.textContent=t,n.appendChild(r),n.appendChild(s),n.appendChild(i),n.appendChild(c),o.appendChild(n),e.appendChild(o);};var ft=()=>Math.random().toString(36).substring(2),$=ft;var N="https://api.onefootprint.com",j=E,H="footprint-js";var b={["auth"]:"auth_v1",["form"]:"form_v1",["render"]:"render_v1",["update_login_methods"]:"update_auth_methods_v1",["verify"]:"verify_v1",["verify-button"]:"verify_button_v1",["components"]:"verify_v1"};var yt=e=>e.replace(/[A-Z]/g,t=>`_${t.toLowerCase()}`),te=e=>t=>{if(!t||typeof t!="object")return t;let o=Object.entries(t).map(([n,r])=>{let a;return Array.isArray(r)?a=r.map(te(e)):Object(r)===r?a=te(e)(r):a=r,[e(n),a]});return Object.fromEntries(o)},gt=te(yt),q=gt;var ht=(e,t,o,n)=>{let r={tenantDomain:n,sdkKind:e,sdkName:H,sdkVersion:j,logLevel:o,logMessage:t,sessionId:B()};try{fetch(`${N}/org/sdk_telemetry`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(q(r))});}catch(a){}},z=ht;var I=(e,t)=>{let o=`@onefootprint/footprint-js: ${t}`;{let n;try{n=window.location.href;}catch(r){}z(e,t,"info",n);}return o},ne=(e,t)=>{let o=`@onefootprint/footprint-js: ${t}`;{let n;try{n=window.location.href;}catch(r){}z(e,t,"warn",n);}return o},De=(e,t)=>{let o=`@onefootprint/footprint-js: ${t}`;{let n;try{n=window.location.href;}catch(r){}z(e,t,"error",n);}return o};var Be={["auth"]:{["canceled"]:"onCancel",["closed"]:"onClose",["completed"]:"onComplete"},["update_login_methods"]:{["canceled"]:"onCancel",["closed"]:"onClose",["completed"]:"onComplete"},["form"]:{["canceled"]:"onCancel",["closed"]:"onClose",["completed"]:"onComplete"},["verify"]:{["auth"]:"onAuth",["canceled"]:"onCancel",["closed"]:"onClose",["completed"]:"onComplete"},["components"]:{["auth"]:"onAuth",["canceled"]:"onCancel",["closed"]:"onClose",["completed"]:"onComplete",["relayToComponents"]:"onRelayToComponents"},["verify-button"]:{["auth"]:"onAuth",["canceled"]:"onCancel",["clicked"]:"onClick",["closed"]:"onClose",["completed"]:"onComplete"},["render"]:{}},_e={["auth"]:[],["form"]:[],["render"]:[],["update_login_methods"]:[],["verify"]:[],["components"]:[],["verify-button"]:[]};var Ue={["auth"]:["modal","drawer"],["components"]:["modal"],["form"]:["inline","modal","drawer"],["render"]:["inline"],["update_login_methods"]:["modal","drawer"],["verify"]:["modal","drawer"],["verify-button"]:["inline"]},kt=Object.values(R),Ct=(...e)=>{},P=e=>e!=null&&typeof e=="object"&&!Array.isArray(e),re=e=>P(e)&&Object.keys(e).length>0,Pt=(e,t)=>{if(e==="inline"&&!t)throw new Error(`Inline component requires a containerId. Received ${t}`)},J=(e,t)=>{var r;if(!t)return;let o=(r=Ue[e])!=null?r:[];if(!o.includes(t))throw new Error(`Invalid variant: ${JSON.stringify(t)}. Valid variants for ${e} are ${o.join(", ")}`)},A=e=>{var o;let t=(o=Ue[e])!=null?o:[];if(!t.length)throw new Error(`Invalid kind: ${e}`);return t[0]},W=e=>{if(!e)throw new Error("Kind is required");let t=Object.values(_);if(!t.includes(e))throw new Error(`Invalid kind: ${e}. Valid kinds are: ${t.join(", ")}`)},Me=e=>{if(e.kind==="verify-button"){let t=e,{kind:o,appearance:n,variant:r,dialogVariant:a,onClick:d,label:s,containerId:p}=t,i=ke(t,["kind","appearance","variant","dialogVariant","onClick","label","containerId"]);return k(g({},i),{variant:a,kind:"verify"})}};var $e=(e,t)=>(Object.prototype.hasOwnProperty.call(e,t)&&typeof e[t]=="function"?e[t]:void 0)||Ct,ae=(e,t,o)=>{var s;let{kind:n}=e,r=(s=Be[n])!=null?s:{},a={},d=Me(e);return Object.entries(r).forEach(([p,i])=>{let c=p;if(!kt.includes(c))return;let C=$e(e,i),x=c==="closed"||c==="canceled",m=n==="verify-button"&&c==="clicked";a[c]=h=>{C(h),x&&(t==null||t()),m&&d&&(o==null||o(d));};}),a},K=e=>{let{kind:t,variant:o,containerId:n}=e,r=o||A(t);return W(t),J(t,o),Pt(r,n),re(e==null?void 0:e.userData)&&console.warn("userData is deprecated and will be removed in the next major version. Please use bootstrapData instead."),k(g({},e),{variant:r})},w=e=>re(e==null?void 0:e.bootstrapData)?{userData:e.bootstrapData}:re(e==null?void 0:e.userData)?{userData:e.userData}:void 0;var bt=e=>e==="auth";var wt=e=>e==="update_login_methods";var se=e=>e.kind==="components";var ie=e=>typeof e=="string"&&e.length>0,Q=e=>bt(e.kind)&&!!("updateLoginMethods"in e&&e.updateLoginMethods)&&!!e.authToken&&/tok_/.test(e.authToken),vt=e=>wt(e.kind)&&!!e.authToken&&/tok_/.test(e.authToken),de=e=>[Q,vt].some(t=>t(e));var St=!1,Vt=e=>de(e)?"update_auth_methods_v1":b[e.kind],It=e=>{var o,n;let{kind:t}=e;if(t==="verify"||t==="components")return k(g({},w(e)),{publicKey:e.publicKey,authToken:e.authToken,options:e.options,l10n:e.l10n,fixtureResult:(o=e.sandboxOutcome)==null?void 0:o.overallOutcome,documentFixtureResult:(n=e.sandboxOutcome)==null?void 0:n.documentOutcome,sandboxId:e.sandboxId,isComponentsSdk:t==="components",shouldRelayToComponents:t==="components"?e.shouldRelayToComponents:void 0});if(t==="update_login_methods")return k(g({},w(e)),{authToken:e.authToken,options:e.options,l10n:e.l10n});if(t==="auth")return Q(e)?k(g({},w(e)),{authToken:e.authToken,updateLoginMethods:e.updateLoginMethods,options:e.options,l10n:e.l10n}):e.authToken&&St?k(g({},w(e)),{authToken:e.authToken,options:e.options,l10n:e.l10n}):k(g({},w(e)),{publicKey:e.publicKey,options:e.options,l10n:e.l10n});if(t==="form")return {authToken:e.authToken,options:e.options,title:e.title,l10n:e.l10n};if(t==="render")return {authToken:e.authToken,canCopy:e.canCopy,defaultHidden:e.defaultHidden,id:e.id,label:e.label,showHiddenToggle:e.showHiddenToggle,l10n:e.l10n};if(t==="verify-button")return k(g({},w(e)),{publicKey:e.publicKey,options:e.options,authToken:e.authToken,label:e.label,l10n:e.l10n});throw new Error("Invalid kind provided")},At=e=>f(void 0,null,function*(){let t=Vt(e);I(t,"Sending SDK args");let o=It(e),n=yield fetch(`${N}/org/sdk_args`,{method:"POST",headers:{"x-fp-client-version":`${H} ${j} ${t}`.trim(),"Content-Type":"application/json"},body:JSON.stringify({data:q(o),kind:t})});if(!n.ok){let a=yield n.json();throw a.message&&a.support_id?new Error(`${a.message} (Support ID: ${a.support_id})`):new Error("An error occurred while sending SDK args. Please try again later.")}let r=yield n.json();if((r==null?void 0:r.token)===void 0)throw new Error("Token is undefined");return r.token}),Ne=At;var je=({fontSrc:e,variables:t={},rules:o={},variant:n}={})=>{let r=()=>Object.keys(t).length?encodeURIComponent(JSON.stringify(t)):void 0,a=()=>Object.keys(o).length?encodeURIComponent(JSON.stringify(o)):void 0;return {fontSrc:e,variables:r(),rules:a(),variant:n}},He=()=>{let e=window.footprintAppearance;return !e||!P(e)?{}:{fontSrc:e.fontSrc,rules:e.rules,variables:e.variables}};var qe=()=>{var e;return typeof window!="undefined"?((e=window.location)==null?void 0:e.href)||window.location.toString():""},xt=(e,t)=>{let{appearance:o,kind:n,l10n:r,variant:a}=e,{fontSrc:d,rules:s,variables:p}=je(o),i=new URLSearchParams;return p&&i.append("variables",p),s&&i.append("rules",s),d&&i.append("font_src",d),r!=null&&r.language&&i.append("lng",r.language),i.append("variant",a||A(n)),`${i.toString()}#${t}`},Ot=(e,t)=>{let{kind:o}=e,n=xt(e,t),r=`https://components.onefootprint.com/${o}`,a=`https://components2.onefootprint.com/${o}`;if(o==="update_login_methods"&&(r="https://auth.onefootprint.com/user",a="https://auth2.onefootprint.com/user"),o==="auth"&&(r="https://auth.onefootprint.com",a="https://auth2.onefootprint.com"),(o==="verify"||o==="verify-button"||o==="components")&&(r="https://id.onefootprint.com",a="https://id2.onefootprint.com"),!ie(r))throw new Error(`${o}_URL environment variable is not defined.`);return r+=`?${n}`.trim(),a+=`?${n}`.trim(),{url:r,fallbackUrl:a}},ze=Ot;var Lt=e=>{let t=null,o=!1,n,r,{formSaveComplete:a,formSaved:d,formSaveFailed:s,started:p}=U,i=K(e),{variant:c,containerId:C}=i,x=c==="modal"||c==="drawer",m=$();I(b[i.kind],Et(i));let h=(l,u)=>{var S;let y=De(b[i.kind],l);(S=i.onError)==null||S.call(i,y),o&&u&&(n(),o=!1);},Ye=()=>{if(!t){h("Footprint should be initialized in order to register callback props");return}let l=ae(i,n,r);Object.entries(l).forEach(([u,y])=>{t==null||t.on(u,y),t==null||t.on(`${m}:${u}`,y);});},Ze=()=>{if(x)return Le(m);if(!C){h("containerId is required when rendering inline");return}let l=document.getElementById(C);if(!l){h(`Could not find container with id ${C} while rendering footprint`);return}return Ee(m,l)},X=(l,u)=>{if(!u){Z(m),t==null||t.frame.classList.remove("fp-hide"),t==null||t.frame.classList.remove(`footprint-${c}-loading`),t==null||t.frame.classList.add(`footprint-${c}-loaded`);return}if(x){let y=Re(l,m);G(y,m);}else G(l,m);},ce=()=>{var u;if(!t){h("Footprint should be initialized in order to set up refs");return}if(i.kind!=="form"||!i.getRef)return;let l={save:()=>(t||h("Footprint should be initialized to call ref methods"),new Promise((y,S)=>{t==null||t.on(a,()=>{y();}),t==null||t.on(s,O=>{S(O);}),t==null||t.on(`${m}:${a}`,y),t==null||t.on(`${m}:${s}`,S),t==null||t.call(d);}))};(u=i.getRef)==null||u.call(i,l);},me=(l,u)=>f(void 0,null,function*(){try{return t=yield new Ft__default.default({classListArray:[`footprint-${c}`,`footprint-${c}-loading`,"fp-hide"],container:l,name:`footprint-iframe-${m}`,url:u,allow:"otp-credentials; publickey-credentials-get *; camera *; clipboard-write;",model:{authToken:i.authToken,initId:m,sdkUrl:qe(),sdkVersion:E||""}}),{success:!0,parentApi:t}}catch(y){return h(`Initializing iframe with ${new URL(u).host} failed with error ${y}`),{success:!1}}}),Ge=(S,O)=>f(void 0,[S,O],function*(l,{url:u,fallbackUrl:y}){let F=b[i.kind];I(F,`Initializing iframe with ${new URL(u).host}`);let ue=yield me(l,u);if(ue.success)return ue.parentApi;I(F,`Initializing iframe with ${new URL(y).host} as fallback`);let fe=yield me(l,y);if(!fe.success)throw new Error("Failed to initialize iframe");return fe.parentApi});return {relayFromComponents:()=>{t&&(t.call("relayFromComponents"),Ke(m));},props:i,isRendered:o,render:()=>f(void 0,null,function*(){if(o){ne(b[i.kind],"Footprint component is already rendered");return}o=!0;let l=Ze();if(!l){ne(b[i.kind],"Unable to create container for Footprint component");return}l.hasChildNodes()&&(l.innerHTML=""),X(l,!0);let u;try{u=yield Ne(i);}catch(O){let F=`${O instanceof Error?O.message:"Unknown error"}`;X(l,!1),ee(l,F),h(`Unable to get SDK args token: ${F}`,!1);return}let{url:y,fallbackUrl:S}=ze(i,u||"");try{yield Ge(l,{url:L(y),fallbackUrl:L(S)}),Ye();}catch(O){ee(l),o=!1;}X(l,!1),t==null||t.on(p,()=>ce()),t==null||t.on(`${m}:${p}`,ce),i.kind==="components"&&(t==null||t.on(`${m}:${"relayToComponents"}`,()=>{Te(m);}));}),destroy:()=>f(void 0,null,function*(){o&&(o=!1,yield Fe(m),t&&(t.destroy(),t=null));}),registerOnDestroy:l=>{!l||typeof l!="function"||(n=l);},registerOnRenderSecondary:l=>{!l||typeof l!="function"||(r=l);}}},Et=e=>{let{variant:t="-",kind:o="-",l10n:n,authToken:r,publicKey:a}=e;return [`variant: ${t}`,`kind: ${o}`,n&&`l10n: ${JSON.stringify(n)}`,`hasAuthToken: ${!!r}`,`publicKey: ${a!=null?a:"-"}`,`sdkVersion: ${E}`].filter(Boolean).join(", ")},pe=Lt;var v=e=>{let t=K(e);return JSON.stringify(t)},Rt=()=>{let e=Object.create(null);return {getOrCreate:a=>{let d=v(a.props),s=Object.values(e).find(p=>v(p.iframe.props)===d);return s?s.iframe:(e[d]={iframe:a,secondaryIframes:{}},a)},getOrCreateSecondary:(a,d)=>{let s=v(a.props),p=v(d.props);if(!e[s])throw new Error("iframe manager: primary iframe does not exist while adding secondary");let{secondaryIframes:i}=e[s],c=Object.values(i).find(C=>v(C.props)===p);return c||(i[p]=d,d)},remove:a=>{let d=v(a.props),s=e[d];s&&(Object.keys(s.secondaryIframes).forEach(p=>{s.secondaryIframes[p].destroy();}),delete e[d]);},removeSecondary:(a,d)=>{let s=v(a.props),p=v(d.props);if(!e[s])throw new Error("iframe manager: primary iframe does not exist while removing secondary");let{secondaryIframes:i}=e[s],c=i[p];c&&(c.destroy(),delete i[p]);}}},Je=Rt;var Kt=()=>{let e=Je();return {init:o=>{let n=pe(o),r=()=>f(void 0,null,function*(){e.remove(n),yield n.destroy();}),a=i=>f(void 0,null,function*(){e.removeSecondary(n,i),yield i.destroy();}),d=i=>f(void 0,null,function*(){let c=pe(i);c=e.getOrCreateSecondary(n,c),c.registerOnDestroy(()=>{a(c);}),c.render();}),s=()=>f(void 0,null,function*(){n=e.getOrCreate(n),n.registerOnDestroy(r),n.registerOnRenderSecondary(d),yield n.render();}),p={};return se(o)&&(p={relayFromComponents:()=>{n.relayFromComponents();}}),g({render:s,destroy:r},p)}}},Tt=Kt(),le=Tt;var Dt=e=>{window.setTimeout(e,0);},Bt=e=>{if(typeof window=="undefined")return;let t=r=>{var s;let a=(s=window.footprintCallbacks)!=null?s:{};if(!P(a))throw Error("`window.footprintCallbacks` must be a valid mapping from callback names to functions.");return _e[r].forEach(p=>{if(!a[p])throw Error(`Callback '${p}' must be defined in window.footprintCallbacks`)}),a},o=r=>{var m;let a=r.getAttribute("data-kind");W(a);let d=(m=r.getAttribute("data-variant"))!=null?m:A(a);J(a,d);let s=He(),p=t(a),i=r.getAttribute("data-props")||"",c;try{c=JSON.parse(i);}catch(h){throw Error("Could not parse `data-props` for footprint.")}if(!P(c))throw Error("`data-props` on the footprint element has to be a valid JSON object stringified.");let C=$();r.setAttribute("id",C),e.init(g(g({kind:a,variant:d,appearance:s,containerId:r.id},p),c)).render();},n=()=>{let r=document.querySelectorAll("[data-footprint]");r.length&&r.forEach(a=>{o(a);});};document.addEventListener("DOMContentLoaded",()=>Dt(n));},We=Bt;var _t="http://test",Qe=e=>f(void 0,null,function*(){let t=yield fetch(`${_t}/hosted/identify/lite`,{method:"POST",body:JSON.stringify(e)});if(!t.ok)throw Error(t.statusText);return (yield t.json()).user_found}),Ut=e=>f(void 0,null,function*(){if(!P(e))throw new Error("User data must be passed in order to identify an user");let t=e["id.email"],o=e["id.phone_number"];return t&&(yield Qe({email:t}))?!0:o?yield Qe({phone_number:o}):!1}),Xe=Ut;var Vn=le;We(le);

exports.FootprintComponentKind = _;
exports.FootprintPrivateEvent = U;
exports.FootprintPublicEvent = R;
exports.default = Vn;
exports.identifyFootprintUser = Xe;
